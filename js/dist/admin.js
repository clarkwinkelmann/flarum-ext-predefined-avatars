module.exports=function(e){var r={};function t(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var a in e)t.d(n,a,function(r){return e[r]}.bind(null,a));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=6)}([function(e,r){e.exports=flarum.core.compat["common/components/Button"]},,,,function(e,r){e.exports=flarum.core.compat["common/helpers/icon"]},,function(e,r,t){"use strict";t.r(r);var n=t(0),a=t.n(n),i=t(4),s=t.n(i),o=function(){function e(){this.sortingIndex=null,this.showPlaceholderForIndex=0,this.dragoverenterhandler=void 0,this.drophandler=void 0}var r=e.prototype;return r.oncreate=function(e){var r=this;this.dragoverenterhandler=function(t){if(null!==r.sortingIndex){t.preventDefault(),t.stopPropagation(),t.dataTransfer.dropEffect="move";var n=0;e.dom.childNodes.forEach((function(r){var a=parseInt(r.dataset.index||"");if(!isNaN(a)){var i=r.getBoundingClientRect();if("horizontal"===e.attrs.direction){if(!i.width)return;var s=i.left+i.width/2;t.pageX>s+window.scrollX&&(n=a+1)}else{if(!i.height)return;var o=i.top+i.height/2;t.pageY>o+window.scrollY&&(n=a+1)}}})),n!==r.showPlaceholderForIndex&&(r.showPlaceholderForIndex=n,m.redraw())}},document.addEventListener("dragover",this.dragoverenterhandler),document.addEventListener("dragenter",this.dragoverenterhandler),this.drophandler=function(t){if(null!==r.sortingIndex){t.preventDefault(),t.stopPropagation();var n=r.sortingIndex,a=r.showPlaceholderForIndex-(r.showPlaceholderForIndex>r.sortingIndex?1:0);r.sortingIndex=null,m.redraw(),a!==n&&e.attrs.onsort(n,a)}},document.addEventListener("drop",this.drophandler)},r.onremove=function(){document.removeEventListener("dragover",this.dragoverenterhandler),document.removeEventListener("dragenter",this.dragoverenterhandler),document.removeEventListener("drop",this.drophandler)},r.view=function(e){var r=this,t=[];return e.children.forEach((function(n,a){null!==r.sortingIndex&&r.showPlaceholderForIndex===a&&t.push(r.placeholder(e)),a===r.sortingIndex&&(n.attrs.style||(n.attrs.style={}),n.attrs.style.display="none"),n.attrs["data-index"]=a,n.attrs.ondragstart=function(t){if(t.target.classList.contains("js-handle")&&!e.attrs.disabled){var n=Array.from(e.dom.childNodes).find((function(e){return e.dataset.index===a+""}));if(!n)return;var i=n.getBoundingClientRect();t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain",a+""),t.dataTransfer.setDragImage(n,t.pageX-i.left-window.scrollX,t.pageY-i.top-window.scrollY),r.sortingIndex=a,r.showPlaceholderForIndex=a}else t.redraw=!1},t.push(n)})),null!==this.sortingIndex&&this.showPlaceholderForIndex===e.children.length&&t.push(this.placeholder(e)),m(e.attrs.containerTag||"div",t)},r.placeholder=function(e){return m(e.attrs.placeholderTag||"div",{className:"SortablePlaceholder",key:"placeholder"},"tr"===e.attrs.placeholderTag?m("td",{colspan:100}):null)},e}();app.initializers.add("clarkwinkelmann-predefined-avatars",(function(){var e=!1;app.extensionData.for("clarkwinkelmann-predefined-avatars").registerSetting({setting:"predefinedAvatarsOnly",type:"switch",label:app.translator.trans("clarkwinkelmann-predefined-avatars.admin.settings.predefinedAvatarsOnly"),help:app.translator.trans("clarkwinkelmann-predefined-avatars.admin.settings.predefinedAvatarsOnlyHelp")}).registerSetting({setting:"predefinedAvatarsNoRemove",type:"switch",label:app.translator.trans("clarkwinkelmann-predefined-avatars.admin.settings.predefinedAvatarsNoRemove"),help:app.translator.trans("clarkwinkelmann-predefined-avatars.admin.settings.predefinedAvatarsNoRemoveHelp")}).registerSetting({setting:"predefinedAvatarsDefault",type:"select",options:{none:app.translator.trans("clarkwinkelmann-predefined-avatars.admin.settings.defaultOptions.none"),first:app.translator.trans("clarkwinkelmann-predefined-avatars.admin.settings.defaultOptions.first"),random:app.translator.trans("clarkwinkelmann-predefined-avatars.admin.settings.defaultOptions.random")},default:"none",label:app.translator.trans("clarkwinkelmann-predefined-avatars.admin.settings.predefinedAvatarsDefault"),help:app.translator.trans("clarkwinkelmann-predefined-avatars.admin.settings.predefinedAvatarsDefaultHelp")}).registerSetting((function(){var r,t=this,n=this.setting("predefinedAvatars")();try{r=JSON.parse(n)}catch(e){console.error("Invalid JSON for predefinedAvatars settings")}return Array.isArray(r)||(r=[]),m(".Form-group",[m("label",app.translator.trans("clarkwinkelmann-predefined-avatars.admin.settings.predefinedAvatars")),m(".helpText",app.translator.trans("clarkwinkelmann-predefined-avatars.admin.settings.predefinedAvatarsHelp")),m(o,{containerTag:"ul.PredefinedAvatars",placeholderTag:"li.Avatar.Avatar--predefined.Avatar--placeholder",direction:"horizontal",onsort:function(e,n){var a;n>=r.length&&(n=r.length-1),(a=r).splice.apply(a,[n,0].concat(r.splice(e,1))),t.setting("predefinedAvatars")(JSON.stringify(r))}},[].concat(r.map((function(e,n){return m("li",{key:e},[m(".Avatar.Avatar--predefined.js-handle",{draggable:!0},m("img",{src:app.forum.attribute("predefinedAvatarsPrefix")+e,alt:e,draggable:!1})),a.a.component({className:"Button Button--icon Button--delete",icon:"fas fa-times",onclick:function(){r.splice(n,1),t.setting("predefinedAvatars")(JSON.stringify(r))}})])})),[m("li",{key:"add"},m("a.Avatar.Avatar--predefined.UploadButton",{href:"#",onclick:function(n){n.preventDefault(),$('<input type="file">').appendTo("body").hide().click().on("change",(function(n){var a=new FormData;a.append("avatar",n.target.files[0]),e=!0,m.redraw(),app.request({method:"POST",url:app.forum.attribute("apiUrl")+"/predefined-avatar-upload",serialize:function(e){return e},body:a}).then((function(n){r.push(n.path),t.setting("predefinedAvatars")(JSON.stringify(r)),e=!1,m.redraw()}),(function(r){throw e=!1,m.redraw(),r}))}))},disabled:e},s()(e?"fas fa-spinner fa-pulse":"fas fa-plus")))]))])})).registerPermission({icon:"fas fa-user-circle",label:app.translator.trans("clarkwinkelmann-predefined-avatars.admin.permissions.setPredefinedAvatar"),permission:"user.setPredefinedAvatar",allowGuest:!0},"reply").registerPermission({icon:"fas fa-user-circle",label:app.translator.trans("clarkwinkelmann-predefined-avatars.admin.permissions.setCustomAvatarAlways"),permission:"user.setCustomAvatarAlways"},"moderate")}))}]);
//# sourceMappingURL=admin.js.map